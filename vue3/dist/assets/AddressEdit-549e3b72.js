import{k as g,u as L,a as b,h as D,a8 as o,o as E,c as A,b as p,a9 as y,aa as w}from"./index-cb6107a9.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{s as k}from"./SimpleHeader-d7cd66ad.js";import{g as R,c as $,E as T,D as j}from"./address-3c90195e.js";const B={class:"address-edit-box"},z={__name:"AddressEdit",setup(C){const l=g(),u=L(),e=b({areaList:{province_list:{},city_list:{},county_list:{}},searchResult:[],type:"add",addressId:"",addressInfo:{},from:l.query.from});D(async()=>{let t={},a={},i={};o.getLev1().forEach(s=>{t[s.id]=s.text,o.getLev2(s.id).forEach(d=>{a[d.id]=d.text,o.getLev3(d.id).forEach(r=>i[r.id]=r.text)})}),e.areaList.province_list=t,e.areaList.city_list=a,e.areaList.county_list=i;const{addressId:m,type:_,from:h}=l.query;if(e.addressId=m,e.type=_,e.from=h||"",_=="edit"){const{data:s}=await R(m);let d="";const r=o.getLev1();Object.entries(e.areaList.county_list).forEach(([c,x])=>{if(x==s.regionName){const I=r.findIndex(n=>n.id.substr(0,2)==c.substr(0,2)),N=Object.entries(e.areaList.city_list).filter(([n,F])=>n.substr(0,4)==c.substr(0,4))[0];r[I].text==s.provinceName&&N[1]==s.cityName&&(d=c)}}),e.addressInfo={id:s.addressId,name:s.userName,tel:s.userPhone,province:s.provinceName,city:s.cityName,county:s.regionName,addressDetail:s.detailAddress,areaCode:d,isDefault:!!s.defaultFlag}}});const f=async t=>{const a={userName:t.name,userPhone:t.tel,provinceName:t.province,cityName:t.city,regionName:t.county,detailAddress:t.addressDetail,defaultFlag:t.isDefault?1:0};e.type=="edit"&&(a.addressId=e.addressId),await e.type=="add"?$(a):T(a),y("保存成功"),setTimeout(()=>{u.back()},1e3)},v=async()=>{await j(e.addressId),y("删除成功"),setTimeout(()=>{u.back()},1e3)};return(t,a)=>{const i=w;return E(),A("div",B,[p(k,{name:`${e.type=="add"?"新增地址":"编辑地址"}`},null,8,["name"]),p(i,{class:"edit","area-list":e.areaList,"address-info":e.addressInfo,"show-delete":e.type=="edit","show-set-default":"","show-search-result":"","search-result":e.searchResult,"area-columns-placeholder":["请选择","请选择","请选择"],onSave:f,onDelete:v},null,8,["area-list","address-info","show-delete","search-result"])])}}};export{z as default};
